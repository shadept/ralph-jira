FROM node:20-slim

WORKDIR /workspace

# Install git (needed for some operations)
RUN apt-get update && \
    apt-get install -y git && \
    rm -rf /var/lib/apt/lists/*

# Install global dependencies
RUN npm install -g tsx

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm ci

# Copy source code
COPY . .

# Default command (kept idle; the web app runs commands via docker compose run)
CMD ["tail", "-f", "/dev/null"]
